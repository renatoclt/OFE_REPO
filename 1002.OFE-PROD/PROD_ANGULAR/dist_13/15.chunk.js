webpackJsonp([15],{"./src/app/login/login.component.html":function(n,o){n.exports='<div class="wrapper wrapper-full-page login">\r\n    <nav class="navbar navbar-primary navbar-transparent navbar-fixed-top">\r\n        <div class="container">\r\n            <div class="navbar-header">\r\n                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#menu-example">\r\n                    <span class="sr-only">Toggle navigation</span>\r\n                    <span class="icon-bar"></span>\r\n                    <span class="icon-bar"></span>\r\n                    <span class="icon-bar"></span>\r\n                </button>\r\n                <a class="navbar-brand" href="/#/dashboard"></a>\r\n            </div>\r\n        </div>\r\n    </nav>\r\n    <div class="full-page login-page" filter-color="black" data-image="./assets/img/login2.jpg">\r\n        \x3c!--   you can change the color of the filter page using: data-color="blue | purple | green | orange | red | rose " --\x3e\r\n        <div class="content">\r\n            <div class="container">\r\n                <div class="row">\r\n                    <div class="col-md-4 col-sm-6 col-md-offset-4 col-sm-offset-3">\r\n                        <form method="#" action="#">\r\n                            <div class="card card-login card-hidden">\r\n                                <div class="card-header text-center" data-background-color="blue">\r\n                                    <h4 class="card-title">Iniciar Sesión</h4>\r\n                                </div>\r\n                                <p class="category text-center">\r\n                                   Bienvenido a B2Mining Data\r\n                                </p>\r\n                                <div class="card-content">\r\n                                    <div class="input-group">\r\n                                        <span class="input-group-addon" style="background: transparent;">\r\n                                            <i class="material-icons">email</i>\r\n                                        </span>\r\n                                        <div class="form-group label-floating">\r\n                                            <label class="control-label">Usuario</label>\r\n                                            <input type="text" id="txtUsuario" class="form-control" name="username" [(ngModel)]="loginModel.username"/>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class="input-group">\r\n                                        <span class="input-group-addon" style="background: transparent;">\r\n                                            <i class="material-icons">lock_outline</i>\r\n                                        </span>\r\n                                        <div class="form-group label-floating">\r\n                                            <label class="control-label">Clave</label>\r\n                                            <input type="password" id="txtClave" class="form-control" name="password" [(ngModel)]="loginModel.password"/>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div class="footer text-right">\r\n                                    <button type="button" (click)="iniciarSesion()" class="btn btn-info btn-simple btn-wd btn-lg" id="btnLogin">Iniciar Sesión</button>\r\n                                </div>\r\n                                \x3c!--\r\n                                <div class="input-group">\r\n                                        <span class="input-group-addon" style="background: transparent;">\r\n                                        </span>\r\n                                        <div class="form-group label-floating">\r\n                                            <a href="#pablo">¿Olvidó su contraseña?</a>\r\n                                        </div>\r\n                                </div>\r\n                                --\x3e\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n\r\n\r\n        <footer class="footer">\r\n            <div class="container">\r\n                \x3c!--<nav class="pull-left">\r\n                    <ul>\r\n                        <li>\r\n                            <a href="#">\r\n                                Inicio\r\n                            </a>\r\n                        </li>\r\n                        <li>\r\n                            <a href="#">\r\n                                Compañía\r\n                            </a>\r\n                        </li>\r\n                        <li>\r\n                            <a href="#">\r\n                                Portafolio\r\n                            </a>\r\n                        </li>\r\n                        <li>\r\n                            <a href="#">\r\n                                Blog\r\n                            </a>\r\n                        </li>\r\n                    </ul>\r\n                </nav>--\x3e\r\n                <p class="copyright text-center">\r\n                    &copy;\r\n                    {{test | date: \'yyyy\'}}\r\n                    <a href="https://www.creative-tim.com">Ebiz</a>, Latin Todos los derechos reservados.<br />\r\n                    Contáctenos: 518 - 3360 | soluciones@ebizlatin.com | Chat en línea\r\n                </p>\r\n            </div>\r\n        </footer>\r\n    </div>\r\n</div>\r\n\r\n\r\n\r\n<div id="mdlOrganizacion" class="modal fade" tabindex="-1" role="dialog">\r\n        <div class="modal-dialog" role="document">\r\n          <div class="modal-content">\r\n            <div class="modal-header">\r\n              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\r\n\r\n              <table>\r\n                <tr>\r\n                  <td>\r\n                    <div class="card-header card-header-icon" data-background-color="blue">\r\n                      <i class="material-icons">assignment</i>\r\n                    </div>\r\n                  </td>\r\n                  <td class="cell-title">\r\n                    <div class="card-content">\r\n                      <h4 class="card-title modal-title">Escoger Organización</h4>\r\n\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              </table>\r\n            </div>\r\n            <div class="modal-body">\r\n\r\n              <div class="card-content">\r\n                <div class="row">\r\n                  <div class="col-sm-12">\r\n                    <div class="form-group label-floating">\r\n                      <label class="control-label">Organización\r\n                            <span class="star"></span>\r\n                          </label>\r\n                          <select id="org_id" name="org_id" class="form-control" [(ngModel)]="usuario.org_id" >\r\n\r\n                                <option *ngFor="let option of organizaciones" value="{{option.id}}"> {{option.nombre}} </option>\r\n\r\n\r\n                            </select>\r\n                    </div>\r\n                  </div>\r\n\r\n                </div>\r\n              </div>\r\n\r\n            </div>\r\n            <div class="modal-footer">\r\n              <button type="button" class="btn btn-default"  (click)="AceptarOrganizacion($event)">Aceptar</button>\r\n\r\n            </div>\r\n          </div>\r\n          \x3c!-- /.modal-content --\x3e\r\n        </div>\r\n        \x3c!-- /.modal-dialog --\x3e\r\n      </div>\r\n'},"./src/app/login/login.component.ts":function(n,o,e){"use strict";var r=e("./node_modules/@angular/core/@angular/core.es5.js"),t=e("./src/app/utils/app.constants.ts"),i=e("./node_modules/@angular/router/@angular/router.es5.js"),a=e("./src/app/model/usuario.ts"),s=e("./src/app/base/base.component.ts"),l=e("./src/app/service/login.service.ts"),c=e("./src/app/service/adjuntoservice.ts"),u=e("./src/app/model/login.ts");e.d(o,"a",function(){return v});var d,g=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var e in o)o.hasOwnProperty(e)&&(n[e]=o[e])};return function(o,e){function r(){this.constructor=o}n(o,e),o.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),p=this&&this.__decorate||function(n,o,e,r){var t,i=arguments.length,a=i<3?o:null===r?r=Object.getOwnPropertyDescriptor(o,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(n,o,e,r);else for(var s=n.length-1;s>=0;s--)(t=n[s])&&(a=(i<3?t(a):i>3?t(o,e,a):t(o,e))||a);return i>3&&a&&Object.defineProperty(o,e,a),a},m=this&&this.__metadata||function(n,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,o)},f=this&&this.__awaiter||function(n,o,e,r){return new(e||(e=Promise))(function(t,i){function a(n){try{l(r.next(n))}catch(n){i(n)}}function s(n){try{l(r.throw(n))}catch(n){i(n)}}function l(n){n.done?t(n.value):new e(function(o){o(n.value)}).then(a,s)}l((r=r.apply(n,o||[])).next())})},b=this&&this.__generator||function(n,o){function e(n){return function(o){return r([n,o])}}function r(e){if(t)throw new TypeError("Generator is already executing.");for(;l;)try{if(t=1,i&&(a=i[2&e[0]?"return":e[0]?"throw":"next"])&&!(a=a.call(i,e[1])).done)return a;switch(i=0,a&&(e=[0,a.value]),e[0]){case 0:case 1:a=e;break;case 4:return l.label++,{value:e[1],done:!1};case 5:l.label++,i=e[1],e=[0];continue;case 7:e=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(6===e[0]||2===e[0])){l=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){l.label=e[1];break}if(6===e[0]&&l.label<a[1]){l.label=a[1],a=e;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(e);break}a[2]&&l.ops.pop(),l.trys.pop();continue}e=o.call(n,l)}catch(n){e=[6,n],i=0}finally{t=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var t,i,a,s,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},v=function(n){function o(o,e,r,i){var s=n.call(this,o)||this;return s.router=e,s.route=r,s.loginService=i,s.test=new Date,s.loading=!1,s.loginModel=new u.a,s.menuOffline=[{front:"PEB2M",logoFront:"https://sab2md.blob.core.windows.net/public-dev/org/logos/b2mining-ico.png",icon:"assignment",title:"Comprobante",modulos:[{idModulo:"03797780-2568-4da9-92a1-0ef545bf8290",moduloUri:"//comprobantes/factura/crear",moduloDesc:"Crear",mini:"CC",default:!1},{idModulo:"03797780-2568-4da9-92a1-0ef545bf8290",moduloUri:"//comprobantes/consultar",moduloDesc:"Consultar",mini:"CS",default:!1}]},{front:"PEB2M",logoFront:"https://sab2md.blob.core.windows.net/public-dev/org/logos/b2mining-ico.png",icon:"assignment",title:"Percepcion/Retencion",modulos:[{idModulo:"03797780-2568-4da9-92a1-0ef545bf8290",moduloUri:"//percepcion-retencion/retencion/crear/individual",moduloDesc:"Crear",mini:"CC",default:!0},{idModulo:"03797780-2568-4da9-92a1-0ef545bf8290",moduloUri:"//percepcion-retencion/consultar",moduloDesc:"Consultar",mini:"CS",default:!1}]},{front:"PEB2M",logoFront:"https://sab2md.blob.core.windows.net/public-dev/org/logos/b2mining-ico.png",icon:"assignment",title:"Comunicacion de bajas",modulos:[{idModulo:"03797780-2568-4da9-92a1-0ef545bf8290",moduloUri:"//resumen-bajas/crear",moduloDesc:"Crear",mini:"CC",default:!0},{idModulo:"03797780-2568-4da9-92a1-0ef545bf8290",moduloUri:"//resumen-bajas/consultar",moduloDesc:"Consultar",mini:"CS",default:!1}]},{front:"PEB2M",logoFront:"https://sab2md.blob.core.windows.net/public-dev/org/logos/b2mining-ico.png",icon:"assignment",title:"Sincronización",modulos:[{idModulo:"03797780-2568-4da9-92a1-0ef545bf8290",moduloUri:"//comprobantes/factura/crear",moduloDesc:"Sincronización",mini:"CC",default:!0}]}],s.organizaciones=[],s.usuario=new a.a,i.logout(),s.base_url=t.a,d=s,s}return g(o,n),o.prototype.AceptarOrganizacion=function(n){var o=this;n&&n.preventDefault(),$("#mdlOrganizacion").modal("toggle");var e=this.usuario.organizaciones.find(function(n){return n.id==o.usuario.org_id});e.nombre.toLowerCase().indexOf("wong")>-1?e.url_image="wong.png":e.nombre.toLowerCase().indexOf("centenario")>-1?e.url_image="centenario.png":e.nombre.toLowerCase().indexOf("abinbev")>-1&&(e.url_image="abinbev.png"),this.usuario.org_url_image=e.url_image,this.usuario.tipo_empresa=e.tipo_empresa,this.usuario.ruc_org=e.ruc,this.usuario.isopais_org=e.isoPais,setTimeout(function(){d.GuardarSession()},100)},o.prototype.checkFullPageBackgroundImage=function(){var n=$(".full-page"),o=n.data("image");if(void 0!==o){var e='<div class="full-page-background" style="background-image: url('+o+') "/>';n.append(e)}},o.prototype.GuardarSession=function(){var n=this;localStorage.setItem("org_id",this.usuario.org_id),localStorage.setItem("username",this.usuario.nombreusuario),this.loginService.sincronizar(this.usuario.org_id,this.loginService.guardarIdioma);var o=this.usuario.organizaciones.find(function(o){return o.id==n.usuario.org_id});localStorage.setItem("tipo_empresa",this.usuario.tipo_empresa),localStorage.setItem("Ocp_Apim_Subscription_Key",o.keySuscripcion),localStorage.setItem("org_nombre",o.nombre),localStorage.setItem("org_ruc",o.ruc),localStorage.setItem("usuarioActual",JSON.stringify(this.usuario)),console.log("--------consume------"),this.loginService.obtenerIdEntidad(localStorage.getItem("org_ruc")),this.loginService.obtenerMenu().subscribe(function(o){localStorage.setItem("menuLateral",JSON.stringify(n.menuOffline)),n.router.navigate([o.moduloUriDefault],{relativeTo:n.route})},function(o){n.messageUtils.showError(o)},function(){})},o.prototype.ObtenerUsuario=function(){return f(this,void 0,void 0,function(){var n,o;return b(this,function(e){switch(e.label){case 0:return n=this,[4,this.loginService.obtenerUser().toPromise()];case 1:return n.usuario=e.sent(),(this.organizaciones=this.usuario.organizaciones,this.organizaciones.length<=0)?(this.finishLoading(),swal({text:"El usuario debe tener asignado al menos una organización.",type:"warning",buttonsStyling:!1,confirmButtonClass:"btn btn-warning"}),[2,!1]):(this.organizaciones.length>1?(this.finishLoading(),$("#mdlOrganizacion").modal("show")):(o=this.organizaciones[0],this.usuario.org_url_image=o.url_image,this.usuario.ruc_org=o.ruc,this.usuario.isopais_org=o.isoPais,this.GuardarSession()),[2])}})})},o.prototype.iniciarSesion=function(){var n=this;return""==this.loginModel.username?(swal({text:"El usuario es un campo requerido.",type:"warning",buttonsStyling:!1,confirmButtonClass:"btn btn-warning"}),!1):""==this.loginModel.password?(swal({text:"El password es un campo requerido.",type:"warning",buttonsStyling:!1,confirmButtonClass:"btn btn-warning"}),!1):(this.loading=!0,this.uiUtils.showOrHideLoadingScreen(this.loading),void this.loginService.login(this.loginModel.username,this.loginModel.password).subscribe(function(o){localStorage.setItem("access_token",o.access_token);var e=new Date((new Date).getTime()+1e3*o.expires_in);localStorage.setItem("expires",e.getTime().toString()),localStorage.setItem("expires_in",o.expires_in),n.ObtenerUsuario(),window.setup(!0)},function(o){n.loginService.loginOffline(n.loginModel.username,n.loginModel.password).subscribe(function(e){if(null!==e){localStorage.setItem("access_token","cdf1fe11-b36c-4be4-8434-557c143341a6");var r=new Date((new Date).getTime()+1728e6);localStorage.setItem("expires",r.getTime().toString()),localStorage.setItem("expires_in","1728000"),n.ObtenerUsuarioOffline(e),swal.close()}else n.finishLoading(),n.messageUtils.showError(o),swal({text:"El usuario o clave ingresado no son los correctos!",type:"warning",buttonsStyling:!1,confirmButtonClass:"btn btn-warning"})},function(o){n.finishLoading(),n.messageUtils.showError(o),swal({text:"El usuario o clave ingresado no son los correctos!",type:"warning",buttonsStyling:!1,confirmButtonClass:"btn btn-warning"})})},function(){}))},o.prototype.ngOnInit=function(){this.checkFullPageBackgroundImage(),setTimeout(function(){$(".card").removeClass("card-hidden")},700),setTimeout(function(){$("select").each(function(){$(this).keydown(),$(this).val()||""!=$(this).val()||$(this.parentElement).addClass("is-empty")})},100)},o.prototype.ngAfterViewInit=function(){DatatableFunctions.ModalSettings(),this.uiUtils.addOrRemoveBodyBackGround(!0,"bckgrd-50percent-login"),this.uiUtils.addOrRemoveStyleFooter(!0,"fixed_full"),$("#txtUsuario").focus()},o.prototype.ngOnDestroy=function(){this.uiUtils.addOrRemoveBodyBackGround(!1,"bckgrd-50percent-login"),this.uiUtils.addOrRemoveStyleFooter(!1,"fixed_full")},o.prototype.finishLoading=function(){this.loading=!1,this.uiUtils.showOrHideLoadingScreen(this.loading)},o.prototype.manejador=function(n){13==n.keyCode&&($("#txtUsuario").is(":focus")||$("#txtClave").is(":focus"))&&$("#btnLogin").focus()},o.prototype.ObtenerUsuarioOffline=function(n){var o={};if(o.id=n.id,o.nombreusuario=n.nombreusuario,o.nombrecompleto=n.nombrecompleto,o.perfil=n.perfil,o.url_image=n.url_image,o.token=n.token,o.org_id=n.org_id,o.tipo_empresa=n.tipo_empresa,o.organizaciones=JSON.parse(n.organizaciones),this.usuario=o,this.organizaciones=this.usuario.organizaciones,this.organizaciones.length<=0)return this.finishLoading(),swal({text:"El usuario debe tener asignado al menos una orgamización.",type:"warning",buttonsStyling:!1,confirmButtonClass:"btn btn-warning"}),!1;if(this.organizaciones.length>1)this.finishLoading(),$("#mdlOrganizacion").modal("show");else{var e=this.organizaciones[0];e.nombre.toLowerCase().indexOf("wong")>-1?e.url_image="wong.png":e.nombre.toLowerCase().indexOf("centenario")>-1?e.url_image="centenario.png":e.nombre.toLowerCase().indexOf("abinbev")>-1&&(e.url_image="abinbev.png"),this.usuario.org_url_image=e.url_image,this.usuario.ruc_org=e.ruc,this.usuario.isopais_org="pprueba",this.GuardarSessionOffline(this.usuario)}},o.prototype.GuardarSessionOffline=function(n){localStorage.setItem("org_id",n.org_id),localStorage.setItem("username",n.nombreusuario);var o=n.organizaciones.find(function(o){return o.id==n.org_id});localStorage.setItem("tipo_empresa",n.tipo_empresa),localStorage.setItem("Ocp_Apim_Subscription_Key",o.keySuscripcion),localStorage.setItem("org_nombre",o.nombre),localStorage.setItem("org_ruc",o.ruc),localStorage.setItem("usuarioActual",JSON.stringify(n)),this.loginService.obtenerIdEntidadOFE(localStorage.getItem("org_ruc")),this.loginService.ObtenerMenuOfe(),null!=n&&(localStorage.setItem("menuLateral",JSON.stringify(this.menuOffline)),this.router.navigate(["/comprobantes/factura/crear"],{relativeTo:this.route}))},o}(s.a);p([e.i(r.HostListener)("document:keydown",["$event"]),m("design:type",Function),m("design:paramtypes",[Object]),m("design:returntype",void 0)],v.prototype,"manejador",null),v=p([e.i(r.Component)({selector:"login-cmp",template:e("./src/app/login/login.component.html"),providers:[l.a,c.a]}),m("design:paramtypes",["function"==typeof(h=void 0!==r.Injector&&r.Injector)&&h||Object,"function"==typeof(y=void 0!==i.b&&i.b)&&y||Object,"function"==typeof(_=void 0!==i.c&&i.c)&&_||Object,"function"==typeof(w=void 0!==l.a&&l.a)&&w||Object])],v);var h,y,_,w},"./src/app/login/login.module.ts":function(n,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=e("./node_modules/@angular/core/@angular/core.es5.js"),t=e("./node_modules/@angular/router/@angular/router.es5.js"),i=e("./node_modules/@angular/common/@angular/common.es5.js"),a=e("./node_modules/@angular/forms/@angular/forms.es5.js"),s=e("./src/app/login/login.component.ts"),l=e("./src/app/login/login.routing.ts"),c=e("./src/app/facturacion-electronica/general/services/tokenInterceptor.service.ts"),u=e("./node_modules/@angular/common/@angular/common/http.es5.js");e.d(o,"LoginModule",function(){return g});var d=this&&this.__decorate||function(n,o,e,r){var t,i=arguments.length,a=i<3?o:null===r?r=Object.getOwnPropertyDescriptor(o,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(n,o,e,r);else for(var s=n.length-1;s>=0;s--)(t=n[s])&&(a=(i<3?t(a):i>3?t(o,e,a):t(o,e))||a);return i>3&&a&&Object.defineProperty(o,e,a),a},g=function(){function n(){}return n}();g=d([e.i(r.NgModule)({imports:[i.CommonModule,t.a.forChild(l.a),a.FormsModule],declarations:[s.a],providers:[{provide:u.c,useClass:c.a,multi:!0}]})],g)},"./src/app/login/login.routing.ts":function(n,o,e){"use strict";var r=e("./src/app/login/login.component.ts");e.d(o,"a",function(){return t});var t=[{path:"",children:[{path:"login",component:r.a}]}]},"./src/app/model/login.ts":function(n,o,e){"use strict";e.d(o,"a",function(){return r});var r=function(){function n(){}return n}()}});