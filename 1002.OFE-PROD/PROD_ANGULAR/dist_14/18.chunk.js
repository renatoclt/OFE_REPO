webpackJsonp([18],{"./src/app/login/login.component.html":function(n,e){n.exports='<div class="wrapper wrapper-full-page login">\r\n    <nav class="navbar navbar-primary navbar-transparent navbar-fixed-top">\r\n        <div class="container">\r\n            <div class="navbar-header">\r\n                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#menu-example">\r\n                    <span class="sr-only">Toggle navigation</span>\r\n                    <span class="icon-bar"></span>\r\n                    <span class="icon-bar"></span>\r\n                    <span class="icon-bar"></span>\r\n                </button>\r\n                <a class="navbar-brand" href="/#/dashboard"></a>\r\n            </div>\r\n        </div>\r\n    </nav>\r\n    <div class="full-page login-page" filter-color="black" data-image="./assets/img/login2.jpg">\r\n        \x3c!--   you can change the color of the filter page using: data-color="blue | purple | green | orange | red | rose " --\x3e\r\n        <div class="content">\r\n            <div class="container">\r\n                <div class="row">\r\n                    <div class="col-md-4 col-sm-6 col-md-offset-4 col-sm-offset-3">\r\n                        <form method="#" action="#">\r\n                            <div class="card card-login card-hidden">\r\n                                <div class="card-header text-center" data-background-color="blue">\r\n                                    <h4 class="card-title">Iniciar Sesión</h4>\r\n                                </div>\r\n                                <p class="category text-center">\r\n                                   Bienvenido a B2Mining Data\r\n                                </p>\r\n                                <div class="card-content">\r\n                                    <div class="input-group">\r\n                                        <span class="input-group-addon" style="background: transparent;">\r\n                                            <i class="material-icons">email</i>\r\n                                        </span>\r\n                                        <div class="form-group label-floating">\r\n                                            <label class="control-label">Usuario</label>\r\n                                            <input type="text" id="txtUsuario" class="form-control" name="username" [(ngModel)]="loginModel.username"/>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class="input-group">\r\n                                        <span class="input-group-addon" style="background: transparent;">\r\n                                            <i class="material-icons">lock_outline</i>\r\n                                        </span>\r\n                                        <div class="form-group label-floating">\r\n                                            <label class="control-label">Clave</label>\r\n                                            <input type="password" id="txtClave" class="form-control" name="password" [(ngModel)]="loginModel.password"/>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div class="footer text-right">\r\n                                    <button type="button" (click)="iniciarSesion()" class="btn btn-info btn-simple btn-wd btn-lg" id="btnLogin">Iniciar Sesión</button>\r\n                                </div>\r\n                                \x3c!--\r\n                                <div class="input-group">\r\n                                        <span class="input-group-addon" style="background: transparent;">\r\n                                        </span>\r\n                                        <div class="form-group label-floating">\r\n                                            <a href="#pablo">¿Olvidó su contraseña?</a>\r\n                                        </div>\r\n                                </div>\r\n                                --\x3e\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n\r\n\r\n        <footer class="footer">\r\n            <div class="container">\r\n                \x3c!--<nav class="pull-left">\r\n                    <ul>\r\n                        <li>\r\n                            <a href="#">\r\n                                Inicio\r\n                            </a>\r\n                        </li>\r\n                        <li>\r\n                            <a href="#">\r\n                                Compañía\r\n                            </a>\r\n                        </li>\r\n                        <li>\r\n                            <a href="#">\r\n                                Portafolio\r\n                            </a>\r\n                        </li>\r\n                        <li>\r\n                            <a href="#">\r\n                                Blog\r\n                            </a>\r\n                        </li>\r\n                    </ul>\r\n                </nav>--\x3e\r\n                <p class="copyright text-center">\r\n                    &copy;\r\n                    {{test | date: \'yyyy\'}}\r\n                    <a href="https://www.creative-tim.com">Ebiz</a>, Latin Todos los derechos reservados.<br />\r\n                    Contáctenos: 518 - 3360 | soluciones@ebizlatin.com | Chat en línea\r\n                </p>\r\n            </div>\r\n        </footer>\r\n    </div>\r\n</div>\r\n\r\n\r\n\r\n<div id="mdlOrganizacion" class="modal fade" tabindex="-1" role="dialog">\r\n        <div class="modal-dialog" role="document">\r\n          <div class="modal-content">\r\n            <div class="modal-header">\r\n              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\r\n\r\n              <table>\r\n                <tr>\r\n                  <td>\r\n                    <div class="card-header card-header-icon" data-background-color="blue">\r\n                      <i class="material-icons">assignment</i>\r\n                    </div>\r\n                  </td>\r\n                  <td class="cell-title">\r\n                    <div class="card-content">\r\n                      <h4 class="card-title modal-title">Escoger Organización</h4>\r\n\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              </table>\r\n            </div>\r\n            <div class="modal-body">\r\n\r\n              <div class="card-content">\r\n                <div class="row">\r\n                  <div class="col-sm-12">\r\n                    <div class="form-group label-floating">\r\n                      <label class="control-label">Organización\r\n                            <span class="star"></span>\r\n                          </label>\r\n                          <select id="org_id" name="org_id" class="form-control" [(ngModel)]="usuario.org_id" >\r\n\r\n                                <option *ngFor="let option of organizaciones" value="{{option.id}}"> {{option.nombre}} </option>\r\n\r\n\r\n                            </select>\r\n                    </div>\r\n                  </div>\r\n\r\n                </div>\r\n              </div>\r\n\r\n            </div>\r\n            <div class="modal-footer">\r\n              <button type="button" class="btn btn-default"  (click)="AceptarOrganizacion($event)">Aceptar</button>\r\n\r\n            </div>\r\n          </div>\r\n          \x3c!-- /.modal-content --\x3e\r\n        </div>\r\n        \x3c!-- /.modal-dialog --\x3e\r\n      </div>\r\n'},"./src/app/login/login.component.ts":function(n,e,o){"use strict";var r=o("./node_modules/@angular/core/@angular/core.es5.js"),t=o("./src/app/utils/app.constants.ts"),i=o("./node_modules/@angular/router/@angular/router.es5.js"),a=o("./src/app/model/usuario.ts"),s=o("./src/app/base/base.component.ts"),l=o("./src/app/service/login.service.ts"),c=o("./src/app/service/adjuntoservice.ts"),u=o("./src/app/model/login.ts");o.d(e,"a",function(){return v});var d,g=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,e){n.__proto__=e}||function(n,e){for(var o in e)e.hasOwnProperty(o)&&(n[o]=e[o])};return function(e,o){function r(){this.constructor=e}n(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),p=this&&this.__decorate||function(n,e,o,r){var t,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(n,e,o,r);else for(var s=n.length-1;s>=0;s--)(t=n[s])&&(a=(i<3?t(a):i>3?t(e,o,a):t(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},m=this&&this.__metadata||function(n,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,e)},f=this&&this.__awaiter||function(n,e,o,r){return new(o||(o=Promise))(function(t,i){function a(n){try{l(r.next(n))}catch(n){i(n)}}function s(n){try{l(r.throw(n))}catch(n){i(n)}}function l(n){n.done?t(n.value):new o(function(e){e(n.value)}).then(a,s)}l((r=r.apply(n,e||[])).next())})},b=this&&this.__generator||function(n,e){function o(n){return function(e){return r([n,e])}}function r(o){if(t)throw new TypeError("Generator is already executing.");for(;l;)try{if(t=1,i&&(a=i[2&o[0]?"return":o[0]?"throw":"next"])&&!(a=a.call(i,o[1])).done)return a;switch(i=0,a&&(o=[0,a.value]),o[0]){case 0:case 1:a=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,i=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){l=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){l.label=o[1];break}if(6===o[0]&&l.label<a[1]){l.label=a[1],a=o;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(o);break}a[2]&&l.ops.pop(),l.trys.pop();continue}o=e.call(n,l)}catch(n){o=[6,n],i=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}var t,i,a,s,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},v=function(n){function e(e,o,r,i){var s=n.call(this,e)||this;return s.router=o,s.route=r,s.loginService=i,s.test=new Date,s.loading=!1,s.loginModel=new u.a,s.menuOffline=[{front:"PEB2M",logoFront:"https://sab2md.blob.core.windows.net/public-dev/org/logos/b2mining-ico.png",icon:"assignment",title:"Comprobante",modulos:[{idModulo:"03797780-2568-4da9-92a1-0ef545bf8290",moduloUri:"//comprobantes/factura/crear",moduloDesc:"Crear",mini:"CC",default:!1},{idModulo:"03797780-2568-4da9-92a1-0ef545bf8290",moduloUri:"//comprobantes/consultar",moduloDesc:"Consultar",mini:"CS",default:!1}]},{front:"PEB2M",logoFront:"https://sab2md.blob.core.windows.net/public-dev/org/logos/b2mining-ico.png",icon:"assignment",title:"Percepcion/Retencion",modulos:[{idModulo:"03797780-2568-4da9-92a1-0ef545bf8290",moduloUri:"//percepcion-retencion/retencion/crear/individual",moduloDesc:"Crear",mini:"CC",default:!0},{idModulo:"03797780-2568-4da9-92a1-0ef545bf8290",moduloUri:"//percepcion-retencion/consultar",moduloDesc:"Consultar",mini:"CS",default:!1}]},{front:"PEB2M",logoFront:"https://sab2md.blob.core.windows.net/public-dev/org/logos/b2mining-ico.png",icon:"assignment",title:"Comunicacion de bajas",modulos:[{idModulo:"03797780-2568-4da9-92a1-0ef545bf8290",moduloUri:"//resumen-bajas/crear",moduloDesc:"Crear",mini:"CC",default:!0},{idModulo:"03797780-2568-4da9-92a1-0ef545bf8290",moduloUri:"//resumen-bajas/consultar",moduloDesc:"Consultar",mini:"CS",default:!1}]},{front:"PEB2M",logoFront:"https://sab2md.blob.core.windows.net/public-dev/org/logos/b2mining-ico.png",icon:"assignment",title:"Sincronización",modulos:[{idModulo:"03797780-2568-4da9-92a1-0ef545bf8290",moduloUri:"//sincronizacion/sincronizar",moduloDesc:"Sincronización",mini:"CC",default:!0}]}],s.organizaciones=[],s.usuario=new a.a,i.logout(),s.base_url=t.a,d=s,s}return g(e,n),e.prototype.AceptarOrganizacion=function(n){var e=this;n&&n.preventDefault(),$("#mdlOrganizacion").modal("toggle");var o=this.usuario.organizaciones.find(function(n){return n.id==e.usuario.org_id});o.nombre.toLowerCase().indexOf("wong")>-1?o.url_image="wong.png":o.nombre.toLowerCase().indexOf("centenario")>-1?o.url_image="centenario.png":o.nombre.toLowerCase().indexOf("abinbev")>-1&&(o.url_image="abinbev.png"),this.usuario.org_url_image=o.url_image,this.usuario.tipo_empresa=o.tipo_empresa,this.usuario.ruc_org=o.ruc,this.usuario.isopais_org=o.isoPais,setTimeout(function(){d.GuardarSession()},100)},e.prototype.checkFullPageBackgroundImage=function(){var n=$(".full-page"),e=n.data("image");if(void 0!==e){var o='<div class="full-page-background" style="background-image: url('+e+') "/>';n.append(o)}},e.prototype.GuardarSession=function(){return f(this,void 0,void 0,function(){var n,e,o,r,t,i,a,s,l,c=this;return b(this,function(u){switch(u.label){case 0:return localStorage.setItem("org_id",this.usuario.org_id),localStorage.setItem("username",this.usuario.nombreusuario),localStorage.setItem("tipo_empresa",this.usuario.tipo_empresa),n=this.usuario.organizaciones.find(function(n){return n.id==c.usuario.org_id}),localStorage.setItem("Ocp_Apim_Subscription_Key",n.keySuscripcion),localStorage.setItem("org_nombre",n.nombre),localStorage.setItem("org_ruc",n.ruc),localStorage.setItem("usuarioActual",JSON.stringify(this.usuario)),console.log("--------consume------"),[4,this.loginService.sincronizar(this.usuario.org_id).toPromise()];case 1:return e=u.sent(),e.count<1?[4,this.loginService.guardarIdioma().toPromise()]:[3,18];case 2:return u.sent(),[4,this.loginService.guardarIdiomaQuery().toPromise()];case 3:return u.sent(),[4,this.loginService.guardarEvento().toPromise()];case 4:return u.sent(),[4,this.loginService.obtenerMaestra().toPromise()];case 5:return o=u.sent(),[4,this.loginService.guardarMaestra(o).toPromise()];case 6:return u.sent(),[4,this.loginService.guardarParemetroEntidad().toPromise()];case 7:return u.sent(),[4,this.loginService.guardarTipoEntidad().toPromise()];case 8:return u.sent(),[4,this.loginService.guardarQueryEstado().toPromise()];case 9:return u.sent(),[4,this.loginService.obtenerEntidad().toPromise()];case 10:return r=u.sent(),[4,this.loginService.guardarEntidad(r).toPromise()];case 11:return u.sent(),[4,this.loginService.obtenerAzure("logo_ebiz.png").toPromise()];case 12:return t=u.sent(),[4,this.loginService.obtenerAzure(r.logoCloud).toPromise()];case 13:return i=u.sent(),[4,this.loginService.obtenerAzure("retenciones-final.xml").toPromise()];case 14:return a=u.sent(),[4,this.loginService.guardarDocumentoAzure("1",r.id,"20",t,i,a)];case 15:return u.sent(),l=(s=this.loginService).guardarSerie,[4,this.loginService.obtenerSerie().toPromise()];case 16:return[4,l.apply(s,[u.sent()]).toPromise()];case 17:u.sent(),u.label=18;case 18:return this.loginService.obtenerIdEntidad(localStorage.getItem("org_ruc")),this.loginService.obtenerMenu().subscribe(function(n){localStorage.setItem("menuLateral",JSON.stringify(c.menuOffline)),c.router.navigate([n.moduloUriDefault],{relativeTo:c.route})},function(n){c.messageUtils.showError(n)},function(){}),[2]}})})},e.prototype.ObtenerUsuario=function(){return f(this,void 0,void 0,function(){var n,e;return b(this,function(o){switch(o.label){case 0:return n=this,[4,this.loginService.obtenerUser().toPromise()];case 1:return n.usuario=o.sent(),(this.organizaciones=this.usuario.organizaciones,this.organizaciones.length<=0)?(this.finishLoading(),swal({text:"El usuario debe tener asignado al menos una organización.",type:"warning",buttonsStyling:!1,confirmButtonClass:"btn btn-warning"}),[2,!1]):(this.organizaciones.length>1?(this.finishLoading(),$("#mdlOrganizacion").modal("show")):(e=this.organizaciones[0],this.usuario.org_url_image=e.url_image,this.usuario.ruc_org=e.ruc,this.usuario.isopais_org=e.isoPais,this.GuardarSession()),[2])}})})},e.prototype.iniciarSesion=function(){var n=this;return""==this.loginModel.username?(swal({text:"El usuario es un campo requerido.",type:"warning",buttonsStyling:!1,confirmButtonClass:"btn btn-warning"}),!1):""==this.loginModel.password?(swal({text:"El password es un campo requerido.",type:"warning",buttonsStyling:!1,confirmButtonClass:"btn btn-warning"}),!1):(this.loading=!0,this.uiUtils.showOrHideLoadingScreen(this.loading),void this.loginService.login(this.loginModel.username,this.loginModel.password).subscribe(function(e){localStorage.setItem("access_token",e.access_token);var o=new Date((new Date).getTime()+1e3*e.expires_in);localStorage.setItem("expires",o.getTime().toString()),localStorage.setItem("expires_in",e.expires_in),n.ObtenerUsuario(),window.setup(!0)},function(e){n.loginService.loginOffline(n.loginModel.username,n.loginModel.password).subscribe(function(o){if(null!==o){localStorage.setItem("access_token","cdf1fe11-b36c-4be4-8434-557c143341a6");var r=new Date((new Date).getTime()+1728e6);localStorage.setItem("expires",r.getTime().toString()),localStorage.setItem("expires_in","1728000"),n.ObtenerUsuarioOffline(o),swal.close()}else n.finishLoading(),n.messageUtils.showError(e),swal({text:"El usuario o clave ingresado no son los correctos!",type:"warning",buttonsStyling:!1,confirmButtonClass:"btn btn-warning"})},function(e){n.finishLoading(),n.messageUtils.showError(e),swal({text:"El usuario o clave ingresado no son los correctos!",type:"warning",buttonsStyling:!1,confirmButtonClass:"btn btn-warning"})})},function(){}))},e.prototype.ngOnInit=function(){this.checkFullPageBackgroundImage(),setTimeout(function(){$(".card").removeClass("card-hidden")},700),setTimeout(function(){$("select").each(function(){$(this).keydown(),$(this).val()||""!=$(this).val()||$(this.parentElement).addClass("is-empty")})},100)},e.prototype.ngAfterViewInit=function(){DatatableFunctions.ModalSettings(),this.uiUtils.addOrRemoveBodyBackGround(!0,"bckgrd-50percent-login"),this.uiUtils.addOrRemoveStyleFooter(!0,"fixed_full"),$("#txtUsuario").focus()},e.prototype.ngOnDestroy=function(){this.uiUtils.addOrRemoveBodyBackGround(!1,"bckgrd-50percent-login"),this.uiUtils.addOrRemoveStyleFooter(!1,"fixed_full")},e.prototype.finishLoading=function(){this.loading=!1,this.uiUtils.showOrHideLoadingScreen(this.loading)},e.prototype.manejador=function(n){13==n.keyCode&&($("#txtUsuario").is(":focus")||$("#txtClave").is(":focus"))&&$("#btnLogin").focus()},e.prototype.ObtenerUsuarioOffline=function(n){var e={};if(e.id=n.id,e.nombreusuario=n.nombreusuario,e.nombrecompleto=n.nombrecompleto,e.perfil=n.perfil,e.url_image=n.url_image,e.token=n.token,e.org_id=n.org_id,e.tipo_empresa=n.tipo_empresa,e.organizaciones=JSON.parse(n.organizaciones),this.usuario=e,this.organizaciones=this.usuario.organizaciones,this.organizaciones.length<=0)return this.finishLoading(),swal({text:"El usuario debe tener asignado al menos una orgamización.",type:"warning",buttonsStyling:!1,confirmButtonClass:"btn btn-warning"}),!1;if(this.organizaciones.length>1)this.finishLoading(),$("#mdlOrganizacion").modal("show");else{var o=this.organizaciones[0];o.nombre.toLowerCase().indexOf("wong")>-1?o.url_image="wong.png":o.nombre.toLowerCase().indexOf("centenario")>-1?o.url_image="centenario.png":o.nombre.toLowerCase().indexOf("abinbev")>-1&&(o.url_image="abinbev.png"),this.usuario.org_url_image=o.url_image,this.usuario.ruc_org=o.ruc,this.usuario.isopais_org="pprueba",this.GuardarSessionOffline(this.usuario)}},e.prototype.GuardarSessionOffline=function(n){localStorage.setItem("org_id",n.org_id),localStorage.setItem("username",n.nombreusuario);var e=n.organizaciones.find(function(e){return e.id==n.org_id});localStorage.setItem("tipo_empresa",n.tipo_empresa),localStorage.setItem("Ocp_Apim_Subscription_Key",e.keySuscripcion),localStorage.setItem("org_nombre",e.nombre),localStorage.setItem("org_ruc",e.ruc),localStorage.setItem("usuarioActual",JSON.stringify(n)),this.loginService.obtenerIdEntidadOFE(localStorage.getItem("org_ruc")),this.loginService.ObtenerMenuOfe(),null!=n&&(localStorage.setItem("menuLateral",JSON.stringify(this.menuOffline)),this.router.navigate(["/comprobantes/factura/crear"],{relativeTo:this.route}))},e}(s.a);p([o.i(r.HostListener)("document:keydown",["$event"]),m("design:type",Function),m("design:paramtypes",[Object]),m("design:returntype",void 0)],v.prototype,"manejador",null),v=p([o.i(r.Component)({selector:"login-cmp",template:o("./src/app/login/login.component.html"),providers:[l.a,c.a]}),m("design:paramtypes",["function"==typeof(h=void 0!==r.Injector&&r.Injector)&&h||Object,"function"==typeof(y=void 0!==i.c&&i.c)&&y||Object,"function"==typeof(_=void 0!==i.b&&i.b)&&_||Object,"function"==typeof(w=void 0!==l.a&&l.a)&&w||Object])],v);var h,y,_,w},"./src/app/login/login.module.ts":function(n,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o("./node_modules/@angular/core/@angular/core.es5.js"),t=o("./node_modules/@angular/router/@angular/router.es5.js"),i=o("./node_modules/@angular/common/@angular/common.es5.js"),a=o("./node_modules/@angular/forms/@angular/forms.es5.js"),s=o("./src/app/login/login.component.ts"),l=o("./src/app/login/login.routing.ts"),c=o("./src/app/facturacion-electronica/general/services/tokenInterceptor.service.ts"),u=o("./node_modules/@angular/common/@angular/common/http.es5.js");o.d(e,"LoginModule",function(){return g});var d=this&&this.__decorate||function(n,e,o,r){var t,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(n,e,o,r);else for(var s=n.length-1;s>=0;s--)(t=n[s])&&(a=(i<3?t(a):i>3?t(e,o,a):t(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},g=function(){function n(){}return n}();g=d([o.i(r.NgModule)({imports:[i.CommonModule,t.a.forChild(l.a),a.FormsModule],declarations:[s.a],providers:[{provide:u.d,useClass:c.a,multi:!0}]})],g)},"./src/app/login/login.routing.ts":function(n,e,o){"use strict";var r=o("./src/app/login/login.component.ts");o.d(e,"a",function(){return t});var t=[{path:"",children:[{path:"login",component:r.a}]}]},"./src/app/model/login.ts":function(n,e,o){"use strict";o.d(e,"a",function(){return r});var r=function(){function n(){}return n}()}});