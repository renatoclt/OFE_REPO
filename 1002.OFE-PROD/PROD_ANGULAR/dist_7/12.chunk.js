webpackJsonp([12],{"./src/app/login/login.component.html":function(n,r){n.exports='<div class="wrapper wrapper-full-page login">\r\n    <nav class="navbar navbar-primary navbar-transparent navbar-fixed-top">\r\n        <div class="container">\r\n            <div class="navbar-header">\r\n                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#menu-example">\r\n                    <span class="sr-only">Toggle navigation</span>\r\n                    <span class="icon-bar"></span>\r\n                    <span class="icon-bar"></span>\r\n                    <span class="icon-bar"></span>\r\n                </button>\r\n                <a class="navbar-brand" href="/#/dashboard"></a>\r\n            </div>\r\n            <div class="collapse navbar-collapse" id="menu-example">\r\n                <ul class="nav navbar-nav navbar-right">\r\n                    <li>\r\n                        <a href="/dashboard">\r\n                            <i class="material-icons">dashboard</i> Dashboard\r\n                        </a>\r\n                    </li>\r\n                    <li class="">\r\n                        <a href="#">\r\n                            <i class="material-icons">person_add</i> Registrarse\r\n                        </a>\r\n                    </li>\r\n                    <li class=" active ">\r\n                        <a href="/login">\r\n                            <i class="material-icons">fingerprint</i> Iniciar Sesión\r\n                        </a>\r\n                    </li>\r\n\r\n                </ul>\r\n            </div>\r\n        </div>\r\n    </nav>\r\n    <div class="full-page login-page" filter-color="black" data-image="./assets/img/login2.jpg">\r\n        \x3c!--   you can change the color of the filter page using: data-color="blue | purple | green | orange | red | rose " --\x3e\r\n        <div class="content">\r\n            <div class="container">\r\n                <div class="row">\r\n                    <div class="col-md-4 col-sm-6 col-md-offset-4 col-sm-offset-3">\r\n                        <form method="#" action="#">\r\n                            <div class="card card-login card-hidden">\r\n                                <div class="card-header text-center" data-background-color="blue">\r\n                                    <h4 class="card-title">Iniciar Sesión</h4>\r\n                                    <div class="social-line">\r\n                                        <a href="#btn" class="btn btn-just-icon btn-simple">\r\n                                            <i class="fa fa-facebook-square"></i>\r\n                                        </a>\r\n                                        <a href="#pablo" class="btn btn-just-icon btn-simple">\r\n                                            <i class="fa fa-twitter"></i>\r\n                                        </a>\r\n                                        <a href="#eugen" class="btn btn-just-icon btn-simple">\r\n                                            <i class="fa fa-google-plus"></i>\r\n                                        </a>\r\n                                    </div>\r\n                                </div>\r\n                                <p class="category text-center">\r\n                                   Bienvenido a B2Mining Data\r\n                                </p>\r\n                                <div class="card-content">\r\n                                    <div class="input-group">\r\n                                        <span class="input-group-addon" style="background: transparent;">\r\n                                            <i class="material-icons">email</i>\r\n                                        </span>\r\n                                        <div class="form-group label-floating">\r\n                                            <label class="control-label">Usuario</label>\r\n                                            <input type="text" id="txtUsuario" class="form-control" name="username" [(ngModel)]="loginModel.username"/>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class="input-group">\r\n                                        <span class="input-group-addon" style="background: transparent;">\r\n                                            <i class="material-icons">lock_outline</i>\r\n                                        </span>\r\n                                        <div class="form-group label-floating">\r\n                                            <label class="control-label">Clave</label>\r\n                                            <input type="password" id="txtClave" class="form-control" name="password" [(ngModel)]="loginModel.password"/>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div class="footer text-right">\r\n                                    <button type="button" (click)="iniciarSesion()" class="btn btn-info btn-simple btn-wd btn-lg" id="btnLogin">Iniciar Sesión</button>\r\n                                </div>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n          \r\n      \r\n        <footer class="footer">\r\n            <div class="container">\r\n                \x3c!--<nav class="pull-left">\r\n                    <ul>\r\n                        <li>\r\n                            <a href="#">\r\n                                Inicio\r\n                            </a>\r\n                        </li>\r\n                        <li>\r\n                            <a href="#">\r\n                                Compañía\r\n                            </a>\r\n                        </li>\r\n                        <li>\r\n                            <a href="#">\r\n                                Portafolio\r\n                            </a>\r\n                        </li>\r\n                        <li>\r\n                            <a href="#">\r\n                                Blog\r\n                            </a>\r\n                        </li>\r\n                    </ul>\r\n                </nav>--\x3e\r\n                <p class="copyright text-center">\r\n                    &copy;\r\n                    {{test | date: \'yyyy\'}}\r\n                    <a href="https://www.creative-tim.com">Ebiz</a>, Latin Todos los derechos reservados.<br />\r\n                    Contáctenos: 518 - 3360 | soluciones@ebizlatin.com | Chat en línea\r\n                </p>\r\n            </div>\r\n        </footer>\r\n    </div>\r\n</div>\r\n\r\n\r\n\r\n<div id="mdlOrganizacion" class="modal fade" tabindex="-1" role="dialog">\r\n        <div class="modal-dialog" role="document">\r\n          <div class="modal-content">\r\n            <div class="modal-header">\r\n              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\r\n      \r\n              <table>\r\n                <tr>\r\n                  <td>\r\n                    <div class="card-header card-header-icon" data-background-color="blue">\r\n                      <i class="material-icons">assignment</i>\r\n                    </div>\r\n                  </td>\r\n                  <td class="cell-title">\r\n                    <div class="card-content">\r\n                      <h4 class="card-title modal-title">Escoger Organización</h4>\r\n      \r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              </table>\r\n            </div>\r\n            <div class="modal-body">\r\n      \r\n              <div class="card-content">\r\n                <div class="row">\r\n                  <div class="col-sm-12">\r\n                    <div class="form-group label-floating">\r\n                      <label class="control-label">Organización\r\n                            <span class="star"></span>\r\n                          </label>\r\n                          <select id="org_id" name="org_id" class="form-control" [(ngModel)]="usuario.org_id" >\r\n                                \r\n                                <option *ngFor="let option of organizaciones" value="{{option.id}}"> {{option.nombre}} </option>           \r\n          \r\n          \r\n                            </select>\r\n                    </div>\r\n                  </div>\r\n                \r\n                </div>\r\n              </div>\r\n            \r\n            </div>\r\n            <div class="modal-footer">\r\n              <button type="button" class="btn btn-default"  (click)="AceptarOrganizacion($event)">Aceptar</button>\r\n      \r\n            </div>\r\n          </div>\r\n          \x3c!-- /.modal-content --\x3e\r\n        </div>\r\n        \x3c!-- /.modal-dialog --\x3e\r\n      </div>'},"./src/app/login/login.component.ts":function(n,r,e){"use strict";var o=e("./node_modules/@angular/core/@angular/core.es5.js"),i=e("./src/app/utils/app.constants.ts"),a=e("./node_modules/@angular/router/@angular/router.es5.js"),t=e("./src/app/model/usuario.ts"),s=e("./src/app/base/base.component.ts"),l=e("./src/app/service/login.service.ts"),c=e("./src/app/model/login.ts");e.d(r,"a",function(){return f});var u=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var e in r)r.hasOwnProperty(e)&&(n[e]=r[e])};return function(r,e){function o(){this.constructor=r}n(r,e),r.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),d=this&&this.__decorate||function(n,r,e,o){var i,a=arguments.length,t=a<3?r:null===o?o=Object.getOwnPropertyDescriptor(r,e):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)t=Reflect.decorate(n,r,e,o);else for(var s=n.length-1;s>=0;s--)(i=n[s])&&(t=(a<3?i(t):a>3?i(r,e,t):i(r,e))||t);return a>3&&t&&Object.defineProperty(r,e,t),t},m=this&&this.__metadata||function(n,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,r)},p=this&&this.__awaiter||function(n,r,e,o){return new(e||(e=Promise))(function(i,a){function t(n){try{l(o.next(n))}catch(n){a(n)}}function s(n){try{l(o.throw(n))}catch(n){a(n)}}function l(n){n.done?i(n.value):new e(function(r){r(n.value)}).then(t,s)}l((o=o.apply(n,r||[])).next())})},g=this&&this.__generator||function(n,r){function e(n){return function(r){return o([n,r])}}function o(e){if(i)throw new TypeError("Generator is already executing.");for(;l;)try{if(i=1,a&&(t=a[2&e[0]?"return":e[0]?"throw":"next"])&&!(t=t.call(a,e[1])).done)return t;switch(a=0,t&&(e=[0,t.value]),e[0]){case 0:case 1:t=e;break;case 4:return l.label++,{value:e[1],done:!1};case 5:l.label++,a=e[1],e=[0];continue;case 7:e=l.ops.pop(),l.trys.pop();continue;default:if(t=l.trys,!(t=t.length>0&&t[t.length-1])&&(6===e[0]||2===e[0])){l=0;continue}if(3===e[0]&&(!t||e[1]>t[0]&&e[1]<t[3])){l.label=e[1];break}if(6===e[0]&&l.label<t[1]){l.label=t[1],t=e;break}if(t&&l.label<t[2]){l.label=t[2],l.ops.push(e);break}t[2]&&l.ops.pop(),l.trys.pop();continue}e=r.call(n,l)}catch(n){e=[6,n],a=0}finally{i=t=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var i,a,t,s,l={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return s={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},f=function(n){function r(r,e,o,a){var s=n.call(this,r)||this;return s.router=e,s.route=o,s.loginService=a,s.test=new Date,s.loading=!1,s.loginModel=new c.a,s.organizaciones=[],s.usuario=new t.a,a.logout(),s.base_url=i.a,s}return u(r,n),r.prototype.AceptarOrganizacion=function(n){var r=this;this.GuardarSession();var e=this.usuario.organizaciones.find(function(n){return n.id==r.usuario.org_id});this.usuario.tipo_empresa=e.tipo_empresa,console.log(e),$("#mdlOrganizacion").modal("toggle"),n&&n.preventDefault()},r.prototype.checkFullPageBackgroundImage=function(){var n=$(".full-page"),r=n.data("image");if(void 0!==r){var e='<div class="full-page-background" style="background-image: url('+r+') "/>';n.append(e)}},r.prototype.GuardarSession=function(){var n=this;localStorage.setItem("org_id",this.usuario.org_id),localStorage.setItem("username",this.usuario.nombreusuario);var r=this.usuario.organizaciones.find(function(r){return r.id==n.usuario.org_id});localStorage.setItem("tipo_empresa",this.usuario.tipo_empresa),localStorage.setItem("Ocp_Apim_Subscription_Key",r.keySuscripcion),localStorage.setItem("org_nombre",r.nombre),localStorage.setItem("org_ruc",r.ruc),localStorage.setItem("usuarioActual",JSON.stringify(this.usuario)),this.loginService.obtenerIdEntidad(localStorage.getItem("org_ruc")),"clasalle"==this.usuario.nombreusuario||"plasalle"==this.usuario.nombreusuario?(localStorage.setItem("menuLateral",JSON.stringify([{icon:"assignment",title:"Percepción/Retención",subnivel:[{link:"/percepcion-retencion/crear-retencion",mini:"O",normal:"Crear"},{link:"/percepcion-retencion/consultar",mini:"G",normal:"Consultar"}]},{icon:"assignment",title:"Resumen de Bajas",subnivel:[{link:"/resumen-bajas/crear",mini:"O",normal:"Crear"},{link:"/resumen-bajas/consultar",mini:"G",normal:"Consultar"}]}])),this.router.navigate(["/percepcion-retencion/consultar"],{relativeTo:this.route})):"comprador"==this.usuario.perfil?(localStorage.setItem("menuLateral",JSON.stringify([{icon:"assignment",title:"Comprador",subnivel:[{link:"/ordencompra/comprador/buscar",mini:"O",normal:"Orden Compra"},{link:"/guia/comprador/buscar",mini:"G",normal:"Guías"},{link:"/conformidadservicio/comprador/buscar",mini:"HAS",normal:"Aceptación de Servicio"},{link:"/factura/comprador/buscar",mini:"CP",normal:"Comprobante de Pago"}]}])),this.router.navigate(["/ordencompra/comprador/buscar"],{relativeTo:this.route})):(localStorage.setItem("menuLateral",JSON.stringify([{icon:"assignment",title:"Proveedor",subnivel:[{link:"/ordencompra/proveedor/buscar",mini:"O",normal:"Orden Compra"},{link:"/guia/proveedor/buscar",mini:"G",normal:"Guías"},{link:"/conformidadservicio/proveedor/buscar",mini:"HAS",normal:"Aceptación de Servicio"},{link:"/factura/proveedor/buscar",mini:"CP",normal:"Comprobante de Pago"}]}])),this.router.navigate(["/ordencompra/proveedor/buscar"],{relativeTo:this.route}))},r.prototype.ObtenerUsuario=function(){return p(this,void 0,void 0,function(){var n;return g(this,function(r){switch(r.label){case 0:return n=this,[4,this.loginService.obtenerUser().toPromise()];case 1:return n.usuario=r.sent(),(this.organizaciones=this.usuario.organizaciones,this.organizaciones.length<=0)?(this.finishLoading(),swal({text:"El usuario debe tener asignado al menos una orgamización.",type:"warning",buttonsStyling:!1,confirmButtonClass:"btn btn-warning"}),[2,!1]):(this.organizaciones.length>1?(setTimeout(function(){$("select").each(function(){$(this).keydown(),$(this).val()||""!=$(this).val()||$(this.parentElement).addClass("is-empty")})},100),this.finishLoading(),$("#mdlOrganizacion").modal("show")):this.GuardarSession(),[2])}})})},r.prototype.iniciarSesion=function(){var n=this;return""==this.loginModel.username?(swal({text:"El usuario es un campo requerido.",type:"warning",buttonsStyling:!1,confirmButtonClass:"btn btn-warning"}),!1):""==this.loginModel.password?(swal({text:"El password es un campo requerido.",type:"warning",buttonsStyling:!1,confirmButtonClass:"btn btn-warning"}),!1):(this.loading=!0,this.uiUtils.showOrHideLoadingScreen(this.loading),void this.loginService.login(this.loginModel.username,this.loginModel.password).subscribe(function(r){localStorage.setItem("access_token",r.access_token);var e=new Date((new Date).getTime()+1e3*r.expires_in);localStorage.setItem("expires",e.getTime().toString()),localStorage.setItem("expires_in",r.expires_in),n.ObtenerUsuario()},function(r){n.loginService.loginOffline(n.loginModel.username,n.loginModel.password).subscribe(function(e){null!==e?(n.ObtenerUsuarioOffline(e),swal.close()):(n.finishLoading(),n.messageUtils.showError(r),swal({text:"El usuario o clave ingresado no son los correctos!",type:"warning",buttonsStyling:!1,confirmButtonClass:"btn btn-warning"}))},function(r){n.finishLoading(),n.messageUtils.showError(r),swal({text:"El usuario o clave ingresado no son los correctos!",type:"warning",buttonsStyling:!1,confirmButtonClass:"btn btn-warning"})})},function(){}))},r.prototype.ngOnInit=function(){this.checkFullPageBackgroundImage(),setTimeout(function(){$(".card").removeClass("card-hidden")},700)},r.prototype.ngAfterViewInit=function(){DatatableFunctions.ModalSettings(),this.uiUtils.addOrRemoveBodyBackGround(!0,"bckgrd-50percent-login"),this.uiUtils.addOrRemoveStyleFooter(!0,"fixed_full"),$("#txtUsuario").focus()},r.prototype.ngOnDestroy=function(){this.uiUtils.addOrRemoveBodyBackGround(!1,"bckgrd-50percent-login"),this.uiUtils.addOrRemoveStyleFooter(!1,"fixed_full")},r.prototype.finishLoading=function(){this.loading=!1,this.uiUtils.showOrHideLoadingScreen(this.loading)},r.prototype.manejador=function(n){13==n.keyCode&&($("#txtUsuario").is(":focus")||$("#txtClave").is(":focus"))&&$("#btnLogin").focus()},r.prototype.ObtenerUsuarioOffline=function(n){return p(this,void 0,void 0,function(){var r;return g(this,function(e){return r={},r.id=n.id,r.nombreusuario=n.nombreusuario,r.nombrecompleto=n.nombrecompleto,r.perfil=n.perfil,r.url_image=n.url_image,r.token=n.token,r.org_id=n.org_id,r.tipo_empresa=n.tipo_empresa,r.organizaciones=JSON.parse(n.organizaciones),this.usuario=r,this.organizaciones=this.usuario.organizaciones,this.organizaciones.length<=0?(this.finishLoading(),swal({text:"El usuario debe tener asignado al menos una orgamización.",type:"warning",buttonsStyling:!1,confirmButtonClass:"btn btn-warning"}),[2,!1]):(this.organizaciones.length>1?(setTimeout(function(){$("select").each(function(){$(this).keydown(),$(this).val()||""!=$(this).val()||$(this.parentElement).addClass("is-empty")})},0),this.finishLoading(),$("#mdlOrganizacion").modal("show")):this.GuardarSessionOffline(this.usuario),[2])})})},r.prototype.GuardarSessionOffline=function(n){localStorage.setItem("org_id",n.org_id),localStorage.setItem("username",n.nombreusuario);var r=n.organizaciones.find(function(r){return r.id==n.org_id});localStorage.setItem("tipo_empresa",n.tipo_empresa),localStorage.setItem("Ocp_Apim_Subscription_Key",r.keySuscripcion),localStorage.setItem("org_nombre",r.nombre),localStorage.setItem("org_ruc",r.ruc),localStorage.setItem("usuarioActual",JSON.stringify(n)),null!==n?(localStorage.setItem("menuLateral",JSON.stringify([{icon:"assignment",title:"Comprobantes",subnivel:[{link:"/comprobantes",mini:"O",normal:"Crear"},{link:"/comprobantes/consultar",mini:"G",normal:"Consultar"}]},{icon:"assignment",title:"Percepción/Retención",subnivel:[{link:"/percepcion-retencion/crear-retencion",mini:"O",normal:"Crear"},{link:"/percepcion-retencion/consultar",mini:"G",normal:"Consultar"}]},{icon:"assignment",title:"Guía de Remisión",subnivel:[{link:"/guiaremision/crear",mini:"O",normal:"Crear"},{link:"/guiaremision/consultar",mini:"G",normal:"Consultar"}]},{icon:"assignment",title:"Bienes/Servicios",subnivel:[{link:"/bienesservicios/crear",mini:"O",normal:"Crear"},{link:"/bienesservicios/consultar",mini:"G",normal:"Consultar"}]},{icon:"assignment",title:"Resumen de Boletas",subnivel:[{link:"/boletas/consultar",mini:"G",normal:"Consultar"}]},{icon:"assignment",title:"Resumen de Bajas",subnivel:[{link:"/resumen-bajas/crear",mini:"O",normal:"Crear"},{link:"/resumen-bajas/consultar",mini:"G",normal:"Consultar"}]},{icon:"assignment",title:"Reportes",subnivel:[{link:"/reportes",mini:"G",normal:"Documentos por Emisor"}]},{icon:"assignment",title:"Configuración",subnivel:[{link:"/configuracion/cuenta",mini:"G",normal:"Mi cuenta"},{link:"/configuracion/empresa",mini:"G",normal:"Configuración de la Empresa"},{link:"/configuracion/dominios",mini:"G",normal:"Configuración Parámetros/Dominios"}]}])),this.router.navigate(["/percepcion-retencion/consultar"],{relativeTo:this.route})):"comprador"==n.perfil?(localStorage.setItem("menuLateral",JSON.stringify([{icon:"assignment",title:"Comprador",subnivel:[{link:"/ordencompra/comprador/buscar",mini:"O",normal:"Orden Compra"},{link:"/guia/comprador/buscar",mini:"G",normal:"Guías"},{link:"/conformidadservicio/comprador/buscar",mini:"HAS",normal:"Aceptación de Servicio"},{link:"/factura/comprador/buscar",mini:"CP",normal:"Comprobante de Pago"}]}])),this.router.navigate(["/ordencompra/comprador/buscar"],{relativeTo:this.route})):(localStorage.setItem("menuLateral",JSON.stringify([{icon:"assignment",title:"Proveedor",subnivel:[{link:"/ordencompra/proveedor/buscar",mini:"O",normal:"Orden Compra"},{link:"/guia/proveedor/buscar",mini:"G",normal:"Guías"},{link:"/conformidadservicio/proveedor/buscar",mini:"HAS",normal:"Aceptación de Servicio"},{link:"/factura/proveedor/buscar",mini:"CP",normal:"Comprobante de Pago"}]}])),this.router.navigate(["/ordencompra/proveedor/buscar"],{relativeTo:this.route}))},r}(s.a);d([e.i(o.HostListener)("document:keydown",["$event"]),m("design:type",Function),m("design:paramtypes",[Object]),m("design:returntype",void 0)],f.prototype,"manejador",null),f=d([e.i(o.Component)({selector:"login-cmp",template:e("./src/app/login/login.component.html")}),m("design:paramtypes",["function"==typeof(b=void 0!==o.Injector&&o.Injector)&&b||Object,"function"==typeof(v=void 0!==a.b&&a.b)&&v||Object,"function"==typeof(h=void 0!==a.c&&a.c)&&h||Object,"function"==typeof(y=void 0!==l.a&&l.a)&&y||Object])],f);var b,v,h,y},"./src/app/login/login.module.ts":function(n,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=e("./node_modules/@angular/core/@angular/core.es5.js"),i=e("./node_modules/@angular/router/@angular/router.es5.js"),a=e("./node_modules/@angular/common/@angular/common.es5.js"),t=e("./node_modules/@angular/forms/@angular/forms.es5.js"),s=e("./src/app/login/login.component.ts"),l=e("./src/app/login/login.routing.ts");e.d(r,"LoginModule",function(){return u});var c=this&&this.__decorate||function(n,r,e,o){var i,a=arguments.length,t=a<3?r:null===o?o=Object.getOwnPropertyDescriptor(r,e):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)t=Reflect.decorate(n,r,e,o);else for(var s=n.length-1;s>=0;s--)(i=n[s])&&(t=(a<3?i(t):a>3?i(r,e,t):i(r,e))||t);return a>3&&t&&Object.defineProperty(r,e,t),t},u=function(){function n(){}return n}();u=c([e.i(o.NgModule)({imports:[a.CommonModule,i.a.forChild(l.a),t.FormsModule],declarations:[s.a]})],u)},"./src/app/login/login.routing.ts":function(n,r,e){"use strict";var o=e("./src/app/login/login.component.ts");e.d(r,"a",function(){return i});var i=[{path:"",children:[{path:"login",component:o.a}]}]},"./src/app/model/login.ts":function(n,r,e){"use strict";e.d(r,"a",function(){return o});var o=function(){function n(){}return n}()}});